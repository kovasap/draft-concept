{"version":3,"sources":["app/interface/core.cljs"],"mappings":";;AAkBA,yDAAA,zDAACA,qHAEC,WAAKC,GAAGC;AAAR,AAAA,kDAAA,uFAAA,mFAAA,mFAAA,2CAAA,gEAAA,iBAAA,2CAAA,gEAAA,2BAAA,mFAAA,2CAAA,gEAAA,WAAA,uEAAA,mFAAA,4EAAA,mFAAA,2CAAA,gEAAA,eAAA,2CAAA,gEAAA,iCAAA,4SAAA,5NAKsB,6CAAA,7CAACC,8EAAQ,4CAAA,5CAACC,8FAAQC,iHACzB,kCAAA,lCAACC,oFAAiBD;;AAGnC,yDAAA,zDAACL,oHAEC,0DAAA,1DAACO,0EACD,cAAAC,HAAKP;AAAL,AAAA,IAAAQ,aAAAD;QAAA,AAAAE,4CAAAD,WAAA,IAAA,/DAASP;cAAT,AAAAQ,4CAAAD,WAAA,IAAA,rEAAWE;AAAX,AACE,wDAAA,jDAACC,8CAAMX,8DAAYU;;AAEvB,2DAAA,3DAACE,wKAEC,WAAKZ,GAAGC;AAAR,AACE,OAAA,yFAAUD;;AAId,2DAAA,3DAACY,sNAEC,WAAKZ,GAAGC;AAAR,AACE,OAACY,sBACC,WAAAC;AAAA,AAAA,IAAAC,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;cAAAA,VAAgCI;oBAAhC,AAAAF,4CAAAF,eAAA,3EAAaG;AAAb,AACE,oBAAIA;AACD,6DAAA,tDAACP,8CAAMQ,yEAAoB,AAAChB,4CAAI,AAAA,+FAAaH,IAAIkB;;AACjDC;;GACL,AAAA,qHAAwBnB;;AAG9B,IAAAoB,mBAAA,AAAAC,cAAA,mFAAA,uFAAA,gFAAA;IAAAC,qBAAA;IAAAC,qBAAA;IAAAC,iBAAA;;AAAA,AAAA,GAAA,AAAA,CAAAA,iBAAAD;AAAA,eAAA,AAAAD,wDAAAE,nEAAQS;AAAR,AAAA,AACE,AAACrB,2DACCqB,2DACA;kBAAKjC,GAAGC;AAAR,AAAW,QAACgC,yCAAAA,6CAAAA,NAAGjC,yBAAAA;;;;AAHnB;AAAA,eAAAoB;eAAAE;eAAAC;eAAA,CAAAC,iBAAA;;;;;;;AAAA,IAAAC,2BAAA,AAAAJ,cAAAD;AAAA,AAAA,GAAAK;AAAA,AAAA,IAAAL,uBAAAK;AAAA,AAAA,GAAA,AAAAC,6BAAAN;AAAA,IAAAO,wBAAA,AAAAC,sBAAAR;AAAA,AAAA,eAAA,AAAAS,qBAAAT;eAAAO;eAAA,AAAAG,gBAAAH;eAAA;;;;;;;AAAA,eAAA,AAAAI,gBAAAX,3BAAQa;AAAR,AAAA,AACE,AAACrB,2DACCqB,2DACA;kBAAKjC,GAAGC;AAAR,AAAW,QAACgC,yCAAAA,6CAAAA,NAAGjC,yBAAAA;;;;AAHnB;AAAA,eAAA,AAAAgC,eAAAZ;eAAA;eAAA;eAAA;;;;;;;;AAAA;;;;AAOA,GAAA,QAAAc,gCAAAC,2CAAAC,gDAAAC;AAAA;AAAA,AAAA,AAASC,2BAAK,AAACC,gDAAW,oBAAA,pBAACC;;AAE3B,2BAAA,3BAAMC;AAAN,AAEE,uBAAA,mFAAA,1GAACC;;AACD,OAASJ,gCAAK,sDAAA,tDAACK,yIAAcC;;AAE/B;;;;;gCAAA,hCAAwBC;AAAxB,AAKE,AAACC;;AACD,OAACL","names":["re_frame.core.reg_event_db","db","_","cljs.core.into","cljs.core.map","app.interface.characters/starting-characters","app.interface.utils/associate-by","day8.re_frame.undo.undoable","p__52790","vec__52791","cljs.core.nth","message","cljs.core.assoc","re_frame.core.reg_sub","clojure.walk/postwalk","p__52794","map__52795","cljs.core/--destructure-map","cljs.core.get","character-ids","element","seq__52796","cljs.core/seq","chunk__52797","count__52798","i__52799","temp__5804__auto__","cljs.core/chunked-seq?","c__5565__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","kw","js/app","js/app.interface","js/app.interface.core","js/app.interface.core.root","app.interface.core/root","js/module$node_modules$react_dom$client.createRoot","goog.dom/getElement","app.interface.core/init","re-frame.core/dispatch","reagent.core.as_element","app.interface.view.main/main","app.interface.core/re-render","re-frame.core/clear-subscription-cache!"],"sourcesContent":["(ns app.interface.core\n  (:require [\"react-dom/client\" :refer [createRoot]]\n            [day8.re-frame.http-fx]\n            [day8.re-frame.undo :as undo :refer [undoable]]  \n            [goog.dom :as gdom]\n            [re-frame.core :as rf]\n            [reagent.core :as r]\n            [app.interface.view.main :refer [main]]\n            [app.interface.utils :refer [get-only associate-by]]\n            [app.interface.characters :refer [starting-characters]]\n            [cljs.pprint]\n            [malli.core :as m]\n            [taoensso.timbre :as log]\n            [clojure.walk :as w]))\n\n;; ----------------------------------------------------------------------------\n;; Setup\n\n(rf/reg-event-db\n  :app/setup\n  (fn [db _]\n    {:current-encounter-map\n     [[{:land-type \"forest\"} {:land-type \"clearing\"}]\n      [{:land-type \"clearing\" :character-ids [:hare]}]\n      [{:land-type \"lake\"} {:land-type \"forest\"}]]\n     :player-characters (into [] (map :id starting-characters))\n     :characters (associate-by :id starting-characters)}))\n     \n\n(rf/reg-event-db\n  :message\n  (undoable \"Send message\")\n  (fn [db [_ message]]\n    (assoc db :message message)))\n\n(rf/reg-sub\n  :message\n  (fn [db _]\n    (:message db)))\n\n; The encounter map, but with stuff like characters embedded in it\n; (instead of tracked via references)\n(rf/reg-sub\n  :current-encounter-map-embedded\n  (fn [db _]\n    (w/postwalk \n      (fn [{:keys [character-ids] :as element}]\n        (if character-ids\n           (assoc element :characters (map (:characters db) character-ids))\n           element))\n      (:current-encounter-map db))))\n\n; Nice way to generate subsciptions for many keys.\n(doseq [kw [:current-encounter-map :player-characters :characters]]\n  (rf/reg-sub\n    kw\n    (fn [db _] (kw db))))\n\n;; -- Entry Point -------------------------------------------------------------\n\n(defonce root (createRoot (gdom/getElement \"app\")))\n\n(defn init\n  []\n  (rf/dispatch [:app/setup])\n  (.render root (r/as-element [main])))\n\n(defn- ^:dev/after-load re-render\n  \"The `:dev/after-load` metadata causes this function to be called after\n  shadow-cljs hot-reloads code. This function is called implicitly by its\n  annotation.\"\n  []\n  (rf/clear-subscription-cache!)\n  (init))\n"]}